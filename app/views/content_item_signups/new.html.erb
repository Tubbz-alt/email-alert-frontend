<% page_heading = "What do you want to get alerts about?" %>
<% content_for :title, page_heading + ' - ' + @content_item['title'] %>

<% if live_content_item?(@content_item) %>
  <% content_for :back_link do %>
    <%= render "govuk_publishing_components/components/back_link", {
      href: @content_item['base_path']
    } %>
  <% end %>
<% end %>

<div class="govuk-grid-row">
  <div class="govuk-grid-column-two-thirds">

    <h1 class="govuk-heading-l"><%= page_heading %></h1>

    <%= form_tag({ action: :confirm },
                 method: "get",
                 data: {
                   module: "track-email-alert-signup-choices",
                   track_action: "new_topic",
                   track_category: "email_subscriptions",
                 }) do %>

      <p class="app-email-option">Everything published to GOV.UK about</p>
      <%= render "govuk_publishing_components/components/radio", {
        name: "topic",
        id_prefix: "all",
        items: [{
          value: @content_item['base_path'],
          text: @content_item['title'],
          checked: true,
          conditional: '<p class="govuk-body">This will include alerts about all the topics below</p>'.html_safe
        }]
      } %>

      <p class='app-email-option'>or only one of the following <%= @subscription.child_taxons.count %> sub-topics</p>
      <%= render "govuk_publishing_components/components/radio", {
        name: "topic",
        id_prefix: "topics",
        items: @subscription.child_taxons.each.map { |taxon| {
          :value => taxon['base_path'],
          :text => taxon['title'],
          :conditional => taxon['description'].present? ? ('<p class="govuk-body">This will include: ' + taxon['description'] + '</p>').html_safe : nil
        } }
      } %>

      <%= render "govuk_publishing_components/components/button", {
        text: "Select",
        margin_bottom: true
      } %>
    <% end %>
  </div>
</div>
